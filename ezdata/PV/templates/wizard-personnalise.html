{% extends 'base.html' %}

<head>
  <script>
    {% if messages %}
    {% for message in messages %}
    alert('{{message}}')
    {% endfor %}
    {% endif %}
  </script>
</head>

{% block content %}

<div class="wizard-navigation">
  <div class="progress-with-circle">
    <div class="progress-bar" role="progressbar" aria-valuenow="1" aria-valuemin="2" aria-valuemax="3"
      style="width: 21%"></div>
  </div>
  <ul>
    <li>
      <a href="" data-toggle="tab">
        <div class="icon-circle">
          <i class="ti-user"></i>
        </div>
        Informations génerales
      </a>
    </li>
    <li class="active">
      <a href="" data-toggle="tab">
        <div class="icon-circle">
          <i class="ti-home"></i>
        </div>
        Bâtiments
      </a>
    </li>
    <li>
      <a href="" data-toggle="tab">
        <div class="icon-circle">
          <i class="ti-shine"></i>
        </div>
        Énergie
      </a>
    </li>
    <li>
      <a href="" data-toggle="tab">
        <div class="icon-circle">
          <i class="ti-car"></i>
        </div>
        Mobilité
      </a>
    </li>
  </ul>
</div>

<!--        You can switch " data-color="orange" "  with one of the next bright colors: "blue", "green", "orange", "red", "azure"          -->

<div class="tab-content">
  <h5 class="info-text">Profil personnalisé - Création</h5>
  <p class="category">
    Merci de créer un nouveau profil personnalisé en cas de besoin.
  </p>
  <p class="category">
    La page suivante permet de sélectionner un profil personnalisé existant
    pour l'étude.
  </p>

  <hr class="divider" />

  <form method="POST" name="formC">
    {% csrf_token %}
    <div class="row">
      <div class="col-sm-4 col-sm-offset-2">
        <div class="form-group {% if formC.name.errors %}has-warning has-feedback{% endif %}">
          <label>Nom du profil </label>
          {{ formC.name }}
        </div>
      </div>
      <div class="col-sm-4">
        <div class="form-group {% if formC.name.errors %}has-warning has-feedback{% endif %}">
          <label>Type </label>
          {{ formC.type }}
        </div>
      </div>
    </div>

    <div class="row">
      <div class="col-sm-2">
        <div class="form-group {% if formC.name.errors %}has-warning has-feedback{% endif %}">
          <label>00:00 </label>
          {{ formC.coeff_0 }}
        </div>
        <div class="form-group {% if formC.name.errors %}has-warning has-feedback{% endif %}">
          <label>06:00 </label>
          {{ formC.coeff_6 }}
        </div>
        <div class="form-group {% if formC.name.errors %}has-warning has-feedback{% endif %}">
          <label>12:00 </label>
          {{ formC.coeff_12 }}
        </div>
        <div class="form-group {% if formC.name.errors %}has-warning has-feedback{% endif %}">
          <label>18:00 </label>
          {{ formC.coeff_18 }}
        </div>
      </div>

      <div class="col-sm-2">
        <div class="form-group {% if formC.name.errors %}has-warning has-feedback{% endif %}">
          <label>01:00 </label>
          {{ formC.coeff_1 }}
        </div>
        <div class="form-group {% if formC.name.errors %}has-warning has-feedback{% endif %}">
          <label>07:00 </label>
          {{ formC.coeff_7 }}
        </div>
        <div class="form-group {% if formC.name.errors %}has-warning has-feedback{% endif %}">
          <label>13:00 </label>
          {{ formC.coeff_13 }}
        </div>
        <div class="form-group {% if formC.name.errors %}has-warning has-feedback{% endif %}">
          <label>19:00 </label>
          {{ formC.coeff_19 }}
        </div>
      </div>

      <div class="col-sm-2">
        <div class="form-group {% if formC.name.errors %}has-warning has-feedback{% endif %}">
          <label>02:00 </label>
          {{ formC.coeff_2 }}
        </div>
        <div class="form-group {% if formC.name.errors %}has-warning has-feedback{% endif %}">
          <label>08:00 </label>
          {{ formC.coeff_8 }}
        </div>
        <div class="form-group {% if formC.name.errors %}has-warning has-feedback{% endif %}">
          <label>14:00 </label>
          {{ formC.coeff_14 }}
        </div>
        <div class="form-group {% if formC.name.errors %}has-warning has-feedback{% endif %}">
          <label>20:00 </label>
          {{ formC.coeff_20 }}
        </div>
      </div>

      <div class="col-sm-2">
        <div class="form-group {% if formC.name.errors %}has-warning has-feedback{% endif %}">
          <label>03:00 </label>
          {{ formC.coeff_3 }}
        </div>
        <div class="form-group {% if formC.name.errors %}has-warning has-feedback{% endif %}">
          <label>09:00 </label>
          {{ formC.coeff_9 }}
        </div>
        <div class="form-group {% if formC.name.errors %}has-warning has-feedback{% endif %}">
          <label>15:00 </label>
          {{ formC.coeff_15 }}
        </div>
        <div class="form-group {% if formC.name.errors %}has-warning has-feedback{% endif %}">
          <label>21:00 </label>
          {{ formC.coeff_21 }}
        </div>
      </div>

      <div class="col-sm-2">
        <div class="form-group {% if formC.name.errors %}has-warning has-feedback{% endif %}">
          <label>04:00 </label>
          {{ formC.coeff_4 }}
        </div>
        <div class="form-group {% if formC.name.errors %}has-warning has-feedback{% endif %}">
          <label>10:00 </label>
          {{ formC.coeff_10 }}
        </div>
        <div class="form-group {% if formC.name.errors %}has-warning has-feedback{% endif %}">
          <label>16:00 </label>
          {{ formC.coeff_16 }}
        </div>
        <div class="form-group {% if formC.name.errors %}has-warning has-feedback{% endif %}">
          <label>22:00 </label>
          {{ formC.coeff_22 }}
        </div>
      </div>

      <div class="col-sm-2">
        <div class="form-group {% if formC.name.errors %}has-warning has-feedback{% endif %}">
          <label>05:00 </label>
          {{ formC.coeff_5 }}
        </div>
        <div class="form-group {% if formC.name.errors %}has-warning has-feedback{% endif %}">
          <label>11:00 </label>
          {{ formC.coeff_11 }}
        </div>
        <div class="form-group {% if formC.name.errors %}has-warning has-feedback{% endif %}">
          <label>17:00 </label>
          {{ formC.coeff_17 }}
        </div>
        <div class="form-group {% if formC.name.errors %}has-warning has-feedback{% endif %}">
          <label>23:00 </label>
          {{ formC.coeff_23 }}
        </div>
      </div>
    </div>

    <div class="row">
      <div class="col-md-8 col-sm-offset-2">
        <div class="card card-stats">
          <div class="card-header"></div>
          <div class="card-body">
            <canvas id="line-chart" width="300" height="150"></canvas>
            <script>
              const chart = new Chart(document.getElementById("line-chart"), {
                type: 'bar',
                data: {
                  labels: [...Array(24).keys()].map(i => `${String(i).padStart(2, '0')}:00`),
                  datasets: [{
                    data: {{ graph }},
                type: 'line',
                label: "Consommation du bâtiment",
                borderColor: "#FF0000",
                backgroundColor: "#FDFEFE",
                fill: false,
              }]
                    },
              options: {
                plugins: {
                  filler: {
                    propagate: true,
                                }
                },
                responsive: true,
                  scales: {
                  x: [{
                    stacked: true,
                    scaleLabel: {
                      display: true,
                      labelString: 'Heures'
                    }
                  }],
                    y: [{
                      stacked: true,
                      scaleLabel: {
                        display: true,
                        labelString: 'kW'
                      }
                    }]
                },

                title: {
                  display: false,
                    text: 'Profil énergétique'
                }
              }
            });
              document.querySelectorAll('input[type="number"]').forEach(
                (e) =>
                (e.oninput = function () {
                  const data = [];
                  for (let i = 0; i < 24; i++) {
                    data.push(parseInt(this.form.elements[`coeff_${i}`].value));
                  }
                  chart.data.datasets[0].data = data;
                  chart.update();
                })
              );
            </script>
          </div>
        </div>
      </div>
    </div>

    <div class="wizard-footer">
      <div class="pull-right">
        <input type="submit" class="btn btn-default btn-wd" name="Suivant" value="Suivant" />
      </div>
      <div class="pull-left">
        <input type="submit" class="btn btn-default btn-wd" name="Précédent" value="Précédent" />
      </div>

      <div class="clearfix"></div>

    </div>
  </form>
</div>

{% endblock %}